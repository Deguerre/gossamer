# To enable KILL_SIGNAL run:  bjam define=KILL_SIGNAL_SUPPORT

using gcc ;
import testing ;
using mpi ;

project
    : requirements <threading>multi <debug-symbols>on <link>static <runtime-link>static 
    ;

variant debug-popcnt : debug : <cflags>-mpopcnt <cflags>-msse4.2 ;
variant release-popcnt : release : <cflags>-mpopcnt <cflags>-msse4.2 ;

lib rt : : <name>rt ;
lib zlib : : <name>z ;
lib bz2 : : <name>bz2 ;
lib matio : : <name>matio ;
lib dl : : <name>dl ;
lib sqlite3 : : <name>sqlite3 ;
lib boost_iostreams : : <name>boost_iostreams-mt ;
lib boost_program_options : : <name>boost_program_options-mt ;
lib boost_thread : : <name>boost_thread-mt ;
lib boost_system : : <name>boost_system-mt ;
lib boost_filesystem : : <name>boost_filesystem-mt ;

lib gossapp : GossApp.cc GossOption.cc GossCmdReg.cc GossCmdHelp.cc 
    GossCmdAnnotateKmers.cc
    GossCmdBuildDb.cc
    GossCmdBuildEdgeIndex.cc
    GossCmdBuildEntryEdgeSet.cc
    GossCmdEstimateErrorRate.cc
    GossCmdExtractCoreGenome.cc
    GossCmdBuildGraph.cc
    GossCmdBuildKmerSet.cc
    GossCmdBuildScaffold.cc
    GossCmdBuildSubgraph.cc
    GossCmdBuildSupergraph.cc
    GossCmdClassifyReads.cc
    GossCmdClipLinks.cc
    GossCmdComputeNearKmers.cc
    GossCmdCountComponents.cc
    GossCmdDetectVariants.cc
    GossCmdDotGraph.cc
    GossCmdDotSupergraph.cc
    GossCmdDumpGraph.cc
    GossCmdDumpKmerSet.cc
    GossCmdExtractReads.cc
    GossCmdFilterReads.cc
    GossCmdFixReads.cc
    GossCmdGraphToKmerSet.cc
    GossCmdGroupReads.cc
    GossCmdIntersectKmerSets.cc
    GossCmdLintGraph.cc
    GossCmdMergeAndAnnotateKmerSets.cc
    GossCmdPoolSamples.cc
    GossCmdPopBubbles.cc
    GossCmdPrintContigs.cc
    GossCmdPruneTips.cc
    GossCmdRestoreGraph.cc
    GossCmdScaffold.cc
    GossCmdSubtractKmerSet.cc
    GossCmdThreadPairs.cc
    GossCmdThreadReads.cc
    GossCmdTrimGraph.cc
    GossCmdTrimPaths.cc
    GossCmdUpgradeGraph.cc
    gossamer boost_program_options ;

lib xenomeapp : XenoApp.cc GossOption.cc GossCmdReg.cc GossCmdHelp.cc 
    GossCmdBuildKmerSet.cc
    GossCmdMergeAndAnnotateKmerSets.cc
    GossCmdComputeNearKmers.cc
    GossCmdGroupReads.cc
    gossamer boost_program_options ;

#lib translucentapp : TranslucentApp.cc GossOption.cc GossCmdReg.cc GossCmdHelp.cc 
#    GossCmdBuildGraph.cc
#    GossCmdLintGraph.cc
#    GossCmdTrimGraph.cc
#    GossCmdPruneTips.cc
#    GossCmdPopBubbles.cc
#    TransCmdAssemble.cc
#    TransCmdMergeGraphWithReference.cc
#    TransCmdTrimRelative.cc
#    ResolveTranscripts.cc
#    gossamer boost_program_options ;

#lib electusapp : ElectApp.cc GossOption.cc GossCmdReg.cc GossCmdHelp.cc
#    GossCmdBuildKmerSet.cc
#    GossCmdFilterReads.cc
#    gossamer boost_program_options ;

#lib espressoapp : EspressoApp.cc GossOption.cc GossCmdReg.cc GossCmdHelp.cc
#    KmerSpectrum.cc
#    gossamer boost_program_options ;

lib gossamer :
    App.cc
    AnnotTree.cc
    #AsyncMerge.cc
    BackyardHash.cc
    BzipFilter.cc
    CompactDynamicBitVector.cc
    Debug.cc
    DenseArray.cc
    BigInteger.cc
    EdgeIndex.cc
    EntryEdgeSet.cc
    EstimateGraphStatistics.cc
    ExternalSortUtils.cc
    FileFactory.cc
    GossamerException.cc
    GossFastaReadBaseString.cc
    GossFastqReadBaseString.cc
    GossReadBaseString.cc
    GossReadProcessor.cc
    Graph.cc
    GraphTrimmer.cc
    IntegerArray.cc
    KmerSet.cc
    LevenbergMarquardt.cc
    LineSource.cc
    MachDep.cc
    MultithreadedBatchTask.cc
    Phylogeny.cc
    PhysicalFileFactory.cc
    Profile.cc
    RRRArray.cc
    ScaffoldGraph.cc
    SmallBaseVector.cc
    SparseArray.cc
    StringFileFactory.cc
    SuperGraph.cc
    TourBus.cc
    Utils.cc
    VariableByteArray.cc
    VariableWidthBitArray.cc
    WordyBitVector.cc
    boost_system boost_filesystem boost_iostreams boost_program_options boost_thread zlib bz2 rt dl sqlite3 ;

exe goss : goss.cc gossapp ;

exe gossple : gossple.cc boost_system boost_filesystem boost_thread ;

exe xenome : xenome.cc xenomeapp ;

#exe translucent : translucent.cc translucentapp ;

#exe electus : electus.cc electusapp ;

#exe espresso : espresso.cc espressoapp matio boost_thread ;

unit-test testAnnotTree : testAnnotTree.cc gossamer ; 
unit-test testAsyncMerge : testAsyncMerge.cc gossamer  boost_thread : <threading>multi ; 
unit-test testAtomic : testAtomic.cc gossamer ; 
unit-test testBackgroundLineSource : testBackgroundLineSource.cc gossamer  boost_thread : <threading>multi ; 
unit-test testBackyardHash : testBackyardHash.cc gossamer ; 
unit-test testBigInteger : testBigInteger.cc gossamer ; 
unit-test testBitVecSet : testBitVecSet.cc gossamer ; 
unit-test testBlendedSort : testBlendedSort.cc gossamer boost_thread : <threading>multi ; 
unit-test testBoundedQueue : testBoundedQueue.cc gossamer boost_thread : <threading>multi ; 
unit-test testBzipFilter : testBzipFilter.cc gossamer : <threading>multi ; 
unit-test testCompactDynamicBitVector : testCompactDynamicBitVector.cc gossamer ; 
unit-test testDenseArray : testDenseArray.cc gossamer ; 
unit-test testEdgeAndCount : testEdgeAndCount.cc gossamer ; 
unit-test testEnumerativeCode : testEnumerativeCode.cc gossamer ; 
unit-test testEstimateGraphStatistics : testEstimateGraphStatistics.cc gossamer ; 
unit-test testExternalVarPushSorter : testExternalVarPushSorter.cc gossamer ; 
unit-test testExternalBufferSort : testExternalBufferSort.cc gossamer ; 
unit-test testFastqParser : testFastqParser.cc gossamer ;
unit-test testFeistelHash : testFeistelHash.cc gossamer ;
unit-test testFibHeap : testFibHeap.cc gossamer ; 
unit-test testFixedWidthBitArray : testFixedWidthBitArray.cc gossamer ; 
unit-test testGammaCodec : testGammaCodec.cc gossamer ; 
unit-test testGossReadBaseString : testGossReadBaseString.cc gossamer ; 
unit-test testGossReadSequenceBases : testGossReadSequenceBases.cc gossamer ; 
unit-test testGraph : testGraph.cc gossamer ;
unit-test testJobManager : testJobManager.cc gossamer boost_thread : <threading>multi ; 
unit-test testKmerAligner : testKmerAligner.cc gossapp ;
unit-test testKmerIndex : testKmerIndex.cc gossamer boost_thread : <threading>multi ; 
unit-test testLevenbergMarquardt : testLevenbergMarquardt.cc gossamer ; 
unit-test testLineParser : testLineParser.cc gossamer ; 
unit-test testMultithreadedBatchTask : testMultithreadedBatchTask.cc gossamer ; 
unit-test testPlainLineSource : testPlainLineSource.cc gossamer ; 
unit-test testPhysicalFileFactory : testPhysicalFileFactory.cc gossamer ; 
unit-test testRRRArray : testRRRArray.cc gossamer ; 
unit-test testReverseComplementAdapter : testReverseComplementAdapter.cc gossamer ;
unit-test testRunLengthCodedBitVectorWord : testRunLengthCodedBitVectorWord.cc gossamer ; 
unit-test testRunLengthCodedSet : testRunLengthCodedSet.cc gossamer ; 
unit-test testSimpleHashMap : testSimpleHashMap.cc gossamer ; 
unit-test testSimpleHashSet : testSimpleHashSet.cc gossamer ; 
unit-test testSimpleRangeSet : testSimpleRangeSet.cc gossamer ; 
unit-test testSmallBaseVector : testSmallBaseVector.cc gossamer ; 
unit-test testSortedArrayMap : testSortedArrayMap.cc gossamer ; 
unit-test testSparseArray : testSparseArray.cc gossamer ;
unit-test testSparseArrayView : testSparseArrayView.cc gossamer ;
unit-test testSpinlock : testSpinlock.cc gossamer ;
unit-test testTourBus : testTourBus.cc gossamer ;
unit-test testUtils : testUtils.cc gossamer ;
unit-test testVariableByteArray : testVariableByteArray.cc gossamer ;
unit-test testVariableWidthBitArray : testVariableWidthBitArray.cc gossamer ;
unit-test testWordyBitVector : testWordyBitVector.cc gossamer ; 
unit-test testVByteCodec : testVByteCodec.cc gossamer ; 

unit-test testGossCmdBuildGraph : testGossCmdBuildGraph.cc gossapp ; 
unit-test testGossCmdPrintContigs : testGossCmdPrintContigs.cc gossapp ; 

